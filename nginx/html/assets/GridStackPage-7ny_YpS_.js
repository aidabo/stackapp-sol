/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{d as X,r as c,u as Y,h as Z,K as ee,N as te,m as ae,Q as se,o as oe,T as b,n as F,i as u,a as v,b as s,t as ne,e as n,k as l,w,f as G,F as O,g as ie,j as le,S as re,V as ce,C as de,I as ue,p as pe,l as fe,_ as _e}from"./index-CoFw7xk0.js";import{g as me,_ as ve}from"./base64-iVB-2yUr.js";import{c as ge,u as he}from"./DefaultLayoutStore-D8eKRoAA.js";import{u as we,_ as xe,e as ye,a as Se}from"./DynamicLoader-y4t8jQNW.js";const x=p=>(pe("data-v-9ec61c78"),p=p(),fe(),p),be={class:"flex justify-between align-items-center bg-blue-600 text-white"},Pe={class:"ml-4 flex-1"},ke={class:"text-lg font-bold"},Ie={class:"flex justify-between align-items-center"},Ce=x(()=>s("span",null,[s("i",{class:"fa-solid fa-fire"})],-1)),Ne=[Ce],je=x(()=>s("span",null,[s("i",{class:"fa-solid fa-circle-info"})],-1)),Be=[je],De={class:"p-3"},Ee=x(()=>s("i",{class:"fa fa-arrow-circle-left text-2xl","aria-hidden":"true"},null,-1)),He=[Ee],Fe={class:"page-show"},Ge=x(()=>s("div",{class:"flex flex-col justify-end align-items-center mb-5"},[s("div")],-1)),Oe=X({__name:"GridStackPage",props:{id:{type:String,default:""}},async setup(p,{expose:$}){let g,P;const k=p,h=c([]),f=c([]),i=c(ge()),y=c(!0),d=Y(),I=Z(),R=t=>e=>{e&&(f.value[t]||(f.value[t]=e))},C=ee(ye.gsPageConfigOptions,!1);let _=!1;if(C){const{imports:t}=Se();try{_=([g,P]=te(()=>t(C)),g=await g,P(),g)}catch{}}const{getPageById:V}=_?_.layoutStore():he(),N=_?_.eventHandler():we(),j=async(t,e,a)=>await W(t,e,a);N.fns.invoke=j;const J=ae({...N});se("__page_handlers",J);const S=c(!1),L=c(!0),B=c(!1),D=c([]);oe(async()=>{d.params.id&&d.fullPath.match(/\/page\/r/)?await E(d.params.id):d.params.id&&d.fullPath.match(/\/page\/p/)?await M(d.params.id):k.id?await E(k.id):b.warning("No page id specified!")});const M=async t=>{let e=localStorage.getItem(t);if(e){i.value=JSON.parse(me.decode(e));const a=i.value.grids;h.value=a.map(o=>o.id),F(async()=>{await H(a)}),S.value=!0}else b.warning("No page id or page data found: "+t)},E=async t=>{const e=await V(t);e?(i.value=e,h.value=i.value.grids.map(a=>a.id),F(async()=>{await H(i.value.grids)})):b.warning("No page id found: "+t)},H=async t=>{f.value.forEach((e,a)=>{if(e){const o=t[a];e.load(o.items)}else e.load({id:1,x:2,y:1,h:2})})},T=async t=>{await I.push({name:"createpage",params:{id:t}})},A=t=>{I.push({name:"createpageback",params:{id:i.value.id}})},z=()=>{const t=Array();f.value.forEach((a,o)=>{a&&t.push({id:h.value[o],items:a.save()})});const e=JSON.parse(JSON.stringify(i.value));return e.grids=t,e},K=()=>{D.value=z(),B.value=!0},Q=(t,e)=>f.value.map(a=>a.findCompFn(t,e)).flatMap(a=>a),W=async(t,e,a)=>{const o=Q(t,e).map(m=>{let r=m.f(e,a);return r instanceof Promise?r:Promise.resolve(r)});return await Promise.all(o).then(m=>Promise.resolve(m))},q=async()=>{(await j("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return $({}),(t,e)=>{const a=ce,o=de,m=ue;return u(),v(O,null,[s("div",be,[s("div",Pe,[s("h1",ke,ne(i.value.title),1)]),s("div",Ie,[n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"just for test"},{default:l(()=>[s("button",{onClick:e[0]||(e[0]=w(r=>q(),["prevent"]))},Ne)]),_:1})]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Show page info"},{default:l(()=>[s("button",{onClick:w(K,["prevent"])},Be)]),_:1}),n(xe,{show:B.value,items:D.value},null,8,["show","items"])]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Page preview"},{default:l(()=>[y.value&&!S.value&&L.value?(u(),v("button",{key:0,onClick:e[1]||(e[1]=w(r=>T(i.value.id),["prevent"]))},[s("span",De,[n(m,{size:"25"})])])):G("",!0)]),_:1})]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Go back to page design"},{default:l(()=>[y.value&&S.value?(u(),v("button",{key:0,onClick:e[2]||(e[2]=w(r=>A(-1),["prevent"])),class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white"},He)):G("",!0)]),_:1})]),_:1})])]),s("div",Fe,[(u(!0),v(O,null,ie(h.value,(r,U)=>(u(),v("div",null,[(u(),le(re,null,{default:l(()=>[n(ve,{id:r,ref_for:!0,ref:R(U),pageProps:i.value,pageStatic:y.value},null,8,["id","pageProps","pageStatic"])]),_:2},1024))]))),256)),Ge])],64)}}}),ze=_e(Oe,[["__scopeId","data-v-9ec61c78"]]);export{ze as G};
