import{d as O,r as _,i as r,a as v,w as p,b as t,e as i,k as n,s as A,E as Ge,B as ae,P as oe,o as ne,F as M,g as le,t as ie,J as ce,p as re,l as de,_ as ue,u as Ee,h as Ne,K as De,N as Ve,m as qe,Q as Fe,R as Oe,n as V,q as Be,j as k,f as q,S as pe,T as F,v as ze,I as Te,C as je,U as Le,V as Ae,W as Me,X as te}from"./index-D360syNw.js";import{u as Re,_ as He,e as Je,a as We,G as Ue}from"./DynamicLoader-DoX2xiRE.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{a as Ke,g as se,_ as Qe}from"./base64-CBHBPIpA.js";import{c as Xe,u as Ye,a as Ze}from"./DefaultLayoutStore-kdmfUuRD.js";import{c as et}from"./stack.config-BQiGw8a2.js";/* empty css              */const tt={class:"absolute top-1 right-1 text-xl"},st={key:1,class:"flex flex-col"},at={class:"size-30"},ot=O({__name:"GridMenu",props:{gridId:{type:String,required:!0},lastGrid:{type:Boolean,default:!1}},emits:["grid:remove"],setup(d,{emit:m}){const g=d,x=m,a=_(!1),l=()=>{a.value=!a.value},c=()=>{x("grid:remove",g.gridId),a.value=!a.value};return(C,w)=>{const P=Ge,B=ae,z=oe;return r(),v("div",tt,[a.value?(r(),v("div",st,[t("div",at,[i(z,{content:"Are you sure you want to delete grid ",type:"info",onOk:c},{default:n(()=>[i(B,{type:"secondary",class:"text-lg",disabled:!d.lastGrid},{default:n(()=>[i(P),A("Delete")]),_:1},8,["disabled"])]),_:1})])])):(r(),v("i",{key:0,class:"fa-solid fa-pen-to-square grid-menu",onClick:p(l,["prevent"])}))])}}}),$=d=>(re("data-v-2d19785d"),d=d(),de(),d),nt={class:"flex"},lt={class:"flex-none"},it=$(()=>t("i",{class:"fa fa-solid fa-square-share-nodes"},null,-1)),ct=[it],rt={class:"flex-initial"},dt=$(()=>t("i",{class:"fa fa-solid fa-save"},null,-1)),ut=[dt],pt={class:"flex-initial"},ft=$(()=>t("i",{class:"fa fa-solid fa-refresh"},null,-1)),_t=[ft],vt={class:"flex-initial"},mt=$(()=>t("i",{class:"fa fa-solid fa-eraser"},null,-1)),gt=[mt],ht={class:"flex-initial"},yt=$(()=>t("i",{class:"fa fa-solid fa-arrow-left"},null,-1)),xt=[yt],wt=$(()=>t("div",{id:"trash",style:{padding:"5px","margin-bottom":"10px"},class:"text-center text-white bg-amber-400"},[t("div",null,[t("i",{class:"fa fa-solid fa-trash",style:{"font-size":"250%"}})]),t("div",{class:"py-5"},[t("span",null,"Drop here to remove!")])],-1)),bt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 overflow-y-auto"},kt=["gscomponent"],$t=$(()=>t("div",null,[t("i",{class:"fa fa-solid fa-plus",style:{"font-size":"200%"}})],-1)),Ct={class:"h-10"},St={class:"size-8 my-4"},Pt=O({__name:"GridStackNaviPanel",props:{pannelWidth:{type:Number,required:!0},publish:{type:Function,required:!0},save:{type:Function,required:!0},load:{type:Function,required:!0},clear:{type:Function,required:!0},close:{type:Function,required:!0}},setup(d){const m=d,g=_([]);return ne(()=>{g.value=Ke.map(x=>x.props)}),(x,a)=>(r(),v("div",{id:"pageSidenav",class:"sidenav",style:ce({width:d.pannelWidth+"px"})},[t("div",nt,[t("div",lt,[t("a",{href:"#",class:"mybtn",onClick:a[0]||(a[0]=p(l=>m.publish(),["prevent"]))},ct)]),t("div",rt,[t("a",{href:"#",class:"mybtn",onClick:a[1]||(a[1]=p(l=>m.save(),["prevent"]))},ut)]),t("div",pt,[t("a",{href:"#",class:"mybtn",onClick:a[2]||(a[2]=p(l=>m.load(),["prevent"]))},_t)]),t("div",vt,[t("a",{href:"#",class:"mybtn",onClick:a[3]||(a[3]=p(l=>m.clear(),["prevent"]))},gt)]),t("div",ht,[t("a",{href:"#",class:"mybtn",onClick:a[4]||(a[4]=p(l=>m.close(),["prevent"]))},xt)])]),wt,t("div",bt,[(r(!0),v(M,null,le(g.value,(l,c)=>(r(),v("div",{key:c,class:"newWidget grid-stack-item grid-custom"},[t("div",{class:"grid-stack-item-content drag",gscomponent:l.cname},[$t,t("div",Ct,[t("span",St,ie(l.description||l.cname),1)])],8,kt)]))),128))])],4))}}),It=ue(Pt,[["__scopeId","data-v-2d19785d"]]),y=d=>(re("data-v-6d336080"),d=d(),de(),d),Gt={class:"flex justify-between align-items-center bg-blue-600 text-white"},Et={class:"ml-4 flex-1"},Nt={class:"m-1"},Dt=y(()=>t("i",{class:"fa fa-arrow-circle-right","aria-hidden":"true"},null,-1)),Vt=[Dt],qt={key:0},Ft=y(()=>t("i",{class:"fa fa-solid fa-plus text-white size-6 justify-center mt-2"},null,-1)),Ot=y(()=>t("span",{class:"text-white"},"Increase Grid",-1)),Bt={class:"flex justify-between align-items-center"},zt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-fire"})],-1)),Tt=[zt],jt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-circle-info"})],-1)),Lt=[jt],At=y(()=>t("span",null,[t("i",{class:"fa-solid fa-eye"})],-1)),Mt=[At],Rt=y(()=>t("div",null,"Loading...",-1)),Ht=y(()=>t("div",{class:"flex flex-col justify-end align-items-center mb-5"},[t("div")],-1)),Jt=O({__name:"GridStackCreate",async setup(d,{expose:m}){let g,x;const a=_([]),l=_([]),c=_(Xe()),C=_(!1),w=Ee(),P=Ne(),B=s=>e=>{e&&(l.value[s]||(l.value[s]=e))},z=De(Je.gsPageConfigOptions,!1),{imports:fe}=We(),E=([g,x]=Ve(()=>fe(z)),g=await g,x(),g),{savePage:_e,getPageById:ve}=E?E.layoutStore():Ye(),R=E?E.eventHandler():Re(),T=async(s,e,o)=>await Ce(s,e,o);R.fns.invoke=T;const me=qe({...R});Fe("__page_handlers",me);const I=_(!1),ge=()=>{I.value=!I.value},he=()=>{I.value=!I.value},N=_(300),ye=()=>{N.value=300},xe=()=>{N.value=0},S=_({float:!1,compact:!1}),H=_(!1),J=_([]);ne(async()=>{if(w.params.id&&w.fullPath.match(/\/page\/w/))await W();else if(w.params.id&&w.fullPath.match(/\/page\/b\/w/))await we();else{const s=c.value.grids||[];a.value=s.map(e=>e.id),a.value.length==0&&Z()}}),Oe(()=>{});const j=async s=>{l.value.forEach((e,o)=>{if(e){const f=s[o];e.load(f.items)}else e.load({id:1,x:2,y:1,h:2})})},we=async()=>{let s=localStorage.getItem(w.params.id);if(s){c.value=JSON.parse(se.decode(s));const e=c.value.grids;a.value=e.map(o=>o.id),V(async()=>{await j(e)})}},W=async()=>{let s=w.params.id;s||(s=c.value.id),c.value=await ve(s),a.value=c.value.grids.map(e=>e.id),V(async()=>{await j(c.value.grids)})},L=async(s=!1)=>{const e=Array();l.value.forEach((o,f)=>{o&&e.push({id:a.value[f],items:o.save()})}),c.value.grids=e,await _e(c.value),s||F.success("Saved successfully!")},U=async()=>{l.value.forEach((s,e)=>{s&&s.clear()})},K=async()=>{const s=c.value.id;let e=se.encode(JSON.stringify(X()));localStorage.setItem(s,e),P.push({name:"preview",params:{id:s}})},Q=async()=>{c.value.status="published",await L(!0),F.success("Published successfully!"),setTimeout(()=>{const s=c.value.id;P.push({name:"page",params:{id:s}})},1e3)},be=()=>{P.push({name:"pagelist"})};Be(S.value,()=>{l.value.forEach((s,e)=>{s&&(s.float(S.value.float),S.value.compact&&s.compact(S.value.compact))})},{deep:!0});const X=()=>{const s=Array();l.value.forEach((o,f)=>{o&&s.push({id:a.value[f],items:o.save()})});const e=JSON.parse(JSON.stringify(c.value));return e.grids=s,e},Y=()=>{J.value=X(),H.value=!0},Z=()=>{const s=Ze();a.value.push(s.id),V(()=>{})},ke=async s=>{if(a.value.length==1)F.error("Only one grid in the layout, ignore delete!");else if(a.value.find(e=>e==s))try{const e=a.value.findIndex(o=>o==s);if(e==a.value.length-1){const o=l.value[e];o.clear(),o.destroyGrid(s),a.value.splice(e,1),V(async()=>{const f=l.value.splice(0,l.value.length);a.value.forEach(u=>{const b=f.find(D=>D.props.id==u);l.value.push(b)})})}}catch{F.error("Grid deleted from layout error: "+s)}},$e=(s,e)=>l.value.map(o=>o.findCompFn(s,e)).flatMap(o=>o),Ce=async(s,e,o)=>{const f=$e(s,e).map(u=>{let b=u.f(e,o);return b instanceof Promise?b:Promise.resolve(b)});return await Promise.all(f).then(u=>Promise.resolve(u))},Se=async()=>{(await T("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return m({showInfo:Y,load:j,save:L,clear:U,preview:K,publish:Q,invoke:T}),(s,e)=>{const o=ze,f=Te,u=je,b=Le,D=ae,G=Ae,Pe=Me,Ie=oe;return r(),v(M,null,[i(It,{"pannel-width":N.value,publish:Q,save:L,load:W,clear:U,close:xe},null,8,["pannel-width"]),t("div",Gt,[t("div",Et,[t("h1",Nt,[t("button",{class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white",onClick:p(ye,["prevent"])},Vt),i(u,{class:"ml-64 text-lg font-bold"},{default:n(()=>[I.value?(r(),k(o,{key:1,onChange:he,style:{width:"320px"},modelValue:c.value.title,"onUpdate:modelValue":e[0]||(e[0]=h=>c.value.title=h)},null,8,["modelValue"])):(r(),v("span",qt,ie(c.value.title),1)),i(f,{class:"size-5 cursor-pointer",onClick:p(ge,["prevent"])})]),_:1}),i(u,{class:"mx-8 text-lg"},{default:n(()=>[A(" Compact "),i(b,{class:"mx-3",modelValue:S.value.compact,"onUpdate:modelValue":e[1]||(e[1]=h=>S.value.compact=h),"checked-color":"#14C9C9","unchecked-color":"lightgray"},null,8,["modelValue"])]),_:1}),C.value?q("",!0):(r(),k(u,{key:0,class:"mx-3 text-2xl font-bold",onClick:e[2]||(e[2]=p(h=>Z(),["prevent"]))},{default:n(()=>[i(G,{content:"Add a grid into layout"},{default:n(()=>[i(D,{type:"outline"},{icon:n(()=>[Ft]),default:n(()=>[Ot]),_:1})]),_:1})]),_:1}))])]),t("div",Bt,[i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(G,{content:"just for test"},{default:n(()=>[t("button",{onClick:e[3]||(e[3]=p(h=>Se(),["prevent"]))},Tt)]),_:1})]),_:1}),i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(G,{content:"Show page info"},{default:n(()=>[t("button",{onClick:p(Y,["prevent"])},Lt)]),_:1}),i(He,{show:H.value,items:J.value},null,8,["show","items"])]),_:1}),i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(G,{content:"Page Preview"},{default:n(()=>[C.value?q("",!0):(r(),v("button",{key:0,onClick:e[4]||(e[4]=p(h=>K(),["prevent"]))},Mt))]),_:1})]),_:1}),C.value?q("",!0):(r(),k(u,{key:0,class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(G,{content:"Exit page design"},{default:n(()=>[i(Ie,{content:"Are you sure you want to exit ",type:"info",onOk:be},{default:n(()=>[i(D,{type:"outline",status:"warning",style:{"font-weight":"600"}},{icon:n(()=>[i(Pe,{size:"18"})]),default:n(()=>[A("Exit Design")]),_:1})]),_:1})]),_:1})]),_:1}))])]),t("div",{class:"page-create",style:ce({marginLeft:N.value+"px"})},[(r(!0),v(M,null,le(a.value,(h,ee)=>(r(),v("div",null,[(r(),k(pe,null,{fallback:n(()=>[Rt]),default:n(()=>[(r(),k(Qe,{id:h,ref_for:!0,ref:B(ee),pageProps:c.value,pageStatic:C.value,key:h},{menu:n(()=>[C.value?q("",!0):(r(),k(ot,{key:0,"grid-id":h,"last-grid":ee==a.value.length-1&&a.value.length>1,"onGrid:remove":ke},null,8,["grid-id","last-grid"]))]),_:2},1032,["id","pageProps","pageStatic"]))]),_:2},1024))]))),256)),Ht],4)],64)}}}),Wt=ue(Jt,[["__scopeId","data-v-6d336080"]]),ls=O({__name:"DefaultGsPageCreate",setup(d){return(m,g)=>(r(),k(pe,null,{default:n(()=>[i(te(Ue),{config:te(et)},{default:n(()=>[i(Wt)]),_:1},8,["config"])]),_:1}))}});export{ls as default};
