/* empty css              */import{u as Y,_ as Z,e as ee}from"./DefaultHandler-Cw2NNZis.js";import{d as te,r as c,u as ae,h as se,K as oe,N as ne,m as ie,Q as le,o as re,T as b,n as F,i as u,a as m,b as s,t as ce,e as n,k as l,w,f as G,F as O,g as de,j as ue,S as pe,V as fe,C as _e,I as me,p as ve,l as ge,_ as he}from"./index-D68vIrQ9.js";import{g as we,_ as ye,u as xe}from"./base64-CntOTrl1.js";import{c as Se,u as be}from"./DefaultLayoutStore-CNnqFBO4.js";const y=p=>(ve("data-v-7782908e"),p=p(),ge(),p),Pe={class:"flex justify-between align-items-center bg-blue-600 text-white"},ke={class:"ml-4 flex-1"},Ce={class:"text-lg font-bold"},Ie={class:"flex justify-between align-items-center"},Ne=y(()=>s("span",null,[s("i",{class:"fa-solid fa-fire"})],-1)),He=[Ne],je=y(()=>s("span",null,[s("i",{class:"fa-solid fa-circle-info"})],-1)),Be=[je],De={class:"p-3"},Ee=y(()=>s("i",{class:"fa fa-arrow-circle-left text-2xl","aria-hidden":"true"},null,-1)),Fe=[Ee],Ge={class:"page-show"},Oe=y(()=>s("div",{class:"flex flex-col justify-end align-items-center mb-5"},[s("div")],-1)),$e=te({__name:"GridStackPage",props:{id:{type:String,default:""}},async setup(p,{expose:$}){let v,P;const k=p,g=c([]),f=c([]),i=c(Se()),x=c(!0),d=ae(),C=se(),R=t=>e=>{e&&(f.value[t]||(f.value[t]=e))},I=oe(ee.gsPageConfigOptions,!1),V=async()=>{let t=!1;if(I){const{importConfiged:e}=xe();try{t=await e(I)}catch{}}},h=([v,P]=ne(()=>V()),v=await v,P(),v),{getPageById:J}=h?h.layoutStore():be(),N=h?h.eventHandler():Y(),H=async(t,e,a)=>await q(t,e,a);N.fns.invoke=H;const L=ie({...N});le("__page_handlers",L);const S=c(!1),M=c(!0),j=c(!1),B=c([]);re(async()=>{d.params.id&&d.fullPath.match(/\/page\/r/)?await D(d.params.id):d.params.id&&d.fullPath.match(/\/page\/p/)?await T(d.params.id):k.id?await D(k.id):b.warning("No page id specified!")});const T=async t=>{let e=localStorage.getItem(t);if(e){i.value=JSON.parse(we.decode(e));const a=i.value.grids;g.value=a.map(o=>o.id),F(async()=>{await E(a)}),S.value=!0}else b.warning("No page id or page data found: "+t)},D=async t=>{const e=await J(t);e?(i.value=e,g.value=i.value.grids.map(a=>a.id),F(async()=>{await E(i.value.grids)})):b.warning("No page id found: "+t)},E=async t=>{f.value.forEach((e,a)=>{if(e){const o=t[a];e.load(o.items)}else e.load({id:1,x:2,y:1,h:2})})},A=async t=>{await C.push({name:"createpage",params:{id:t}})},z=t=>{C.push({name:"createpageback",params:{id:i.value.id}})},K=()=>{const t=Array();f.value.forEach((a,o)=>{a&&t.push({id:g.value[o],items:a.save()})});const e=JSON.parse(JSON.stringify(i.value));return e.grids=t,e},Q=()=>{B.value=K(),j.value=!0},W=(t,e)=>f.value.map(a=>a.findCompFn(t,e)).flatMap(a=>a),q=async(t,e,a)=>{const o=W(t,e).map(_=>{let r=_.f(e,a);return r instanceof Promise?r:Promise.resolve(r)});return await Promise.all(o).then(_=>Promise.resolve(_))},U=async()=>{(await H("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return $({}),(t,e)=>{const a=fe,o=_e,_=me;return u(),m(O,null,[s("div",Pe,[s("div",ke,[s("h1",Ce,ce(i.value.title),1)]),s("div",Ie,[n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"just for test"},{default:l(()=>[s("button",{onClick:e[0]||(e[0]=w(r=>U(),["prevent"]))},He)]),_:1})]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Show page info"},{default:l(()=>[s("button",{onClick:w(Q,["prevent"])},Be)]),_:1}),n(Z,{show:j.value,items:B.value},null,8,["show","items"])]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Page preview"},{default:l(()=>[x.value&&!S.value&&M.value?(u(),m("button",{key:0,onClick:e[1]||(e[1]=w(r=>A(i.value.id),["prevent"]))},[s("span",De,[n(_,{size:"25"})])])):G("",!0)]),_:1})]),_:1}),n(o,{class:"mx-3 text-2xl font-bold"},{default:l(()=>[n(a,{content:"Go back to page design"},{default:l(()=>[x.value&&S.value?(u(),m("button",{key:0,onClick:e[2]||(e[2]=w(r=>z(-1),["prevent"])),class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white"},Fe)):G("",!0)]),_:1})]),_:1})])]),s("div",Ge,[(u(!0),m(O,null,de(g.value,(r,X)=>(u(),m("div",null,[(u(),ue(pe,null,{default:l(()=>[n(ye,{id:r,ref_for:!0,ref:R(X),pageProps:i.value,pageStatic:x.value},null,8,["id","pageProps","pageStatic"])]),_:2},1024))]))),256)),Oe])],64)}}}),Te=he($e,[["__scopeId","data-v-7782908e"]]);export{Te as G};
