import{d as B,r as _,i as r,a as v,w as f,b as t,e as l,k as n,s as A,E as Ge,B as ae,P as oe,o as ne,F as H,g as le,t as ie,J as ce,p as re,l as de,_ as ue,u as Ee,h as Ne,K as De,N as Ve,m as qe,Q as Fe,R as Oe,n as q,q as Be,j as b,f as F,S as fe,T as O,v as ze,I as Le,C as Te,U as je,V as Ae,W as He,X as te}from"./index-D68vIrQ9.js";import{u as Me,_ as Re,e as Je,G as We}from"./DefaultHandler-Cw2NNZis.js";import{c as Ue}from"./stack.config-BQiGw8a2.js";/* empty css              *//* empty css              */import{g as se,_ as Ke,u as Qe}from"./base64-CntOTrl1.js";import{c as Xe,u as Ye,a as Ze}from"./DefaultLayoutStore-CNnqFBO4.js";const et={class:"absolute top-1 right-1 text-xl"},tt={key:1,class:"flex flex-col"},st={class:"size-30"},at=B({__name:"GridMenu",props:{gridId:{type:String,required:!0},lastGrid:{type:Boolean,default:!1}},emits:["grid:remove"],setup(d,{emit:m}){const g=d,S=m,a=_(!1),i=()=>{a.value=!a.value},c=()=>{S("grid:remove",g.gridId),a.value=!a.value};return($,x)=>{const P=Ge,z=ae,E=oe;return r(),v("div",et,[a.value?(r(),v("div",tt,[t("div",st,[l(E,{content:"Are you sure you want to delete grid ",type:"info",onOk:c},{default:n(()=>[l(z,{type:"secondary",class:"text-lg",disabled:!d.lastGrid},{default:n(()=>[l(P),A("Delete")]),_:1},8,["disabled"])]),_:1})])])):(r(),v("i",{key:0,class:"fa-solid fa-pen-to-square grid-menu",onClick:f(i,["prevent"])}))])}}}),ot=[{cname:"arcoform",icon:"<i class='fa fa-solid fa-plus'></i>"},{cname:"formexample",icon:"<i class='fa fa-solid fa-plus'></i>"}],k=d=>(re("data-v-e40a1a75"),d=d(),de(),d),nt={class:"flex"},lt={class:"flex-none"},it=k(()=>t("i",{class:"fa fa-solid fa-square-share-nodes"},null,-1)),ct=[it],rt={class:"flex-initial"},dt=k(()=>t("i",{class:"fa fa-solid fa-save"},null,-1)),ut=[dt],ft={class:"flex-initial"},pt=k(()=>t("i",{class:"fa fa-solid fa-refresh"},null,-1)),_t=[pt],vt={class:"flex-initial"},mt=k(()=>t("i",{class:"fa fa-solid fa-eraser"},null,-1)),gt=[mt],ht={class:"flex-initial"},yt=k(()=>t("i",{class:"fa fa-solid fa-arrow-left"},null,-1)),xt=[yt],wt=k(()=>t("div",{id:"trash",style:{padding:"5px","margin-bottom":"10px"},class:"text-center text-white bg-amber-400"},[t("div",null,[t("i",{class:"fa fa-solid fa-trash",style:{"font-size":"250%"}})]),t("div",{class:"py-5"},[t("span",null,"Drop here to remove!")])],-1)),bt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 overflow-y-auto"},kt=["gscomponent"],$t=k(()=>t("div",null,[t("i",{class:"fa fa-solid fa-plus",style:{"font-size":"200%"}})],-1)),Ct={class:"h-10"},St={class:"size-8 my-4"},Pt=B({__name:"GridStackNaviPanel",props:{pannelWidth:{type:Number,required:!0},publish:{type:Function,required:!0},save:{type:Function,required:!0},load:{type:Function,required:!0},clear:{type:Function,required:!0},close:{type:Function,required:!0}},setup(d){const m=d,g=_([]);return ne(()=>{g.value=ot}),(S,a)=>(r(),v("div",{id:"pageSidenav",class:"sidenav",style:ce({width:d.pannelWidth+"px"})},[t("div",nt,[t("div",lt,[t("a",{href:"#",class:"mybtn",onClick:a[0]||(a[0]=f(i=>m.publish(),["prevent"]))},ct)]),t("div",rt,[t("a",{href:"#",class:"mybtn",onClick:a[1]||(a[1]=f(i=>m.save(),["prevent"]))},ut)]),t("div",ft,[t("a",{href:"#",class:"mybtn",onClick:a[2]||(a[2]=f(i=>m.load(),["prevent"]))},_t)]),t("div",vt,[t("a",{href:"#",class:"mybtn",onClick:a[3]||(a[3]=f(i=>m.clear(),["prevent"]))},gt)]),t("div",ht,[t("a",{href:"#",class:"mybtn",onClick:a[4]||(a[4]=f(i=>m.close(),["prevent"]))},xt)])]),wt,t("div",bt,[(r(!0),v(H,null,le(g.value,(i,c)=>(r(),v("div",{key:c,class:"newWidget grid-stack-item grid-custom"},[t("div",{class:"grid-stack-item-content drag",gscomponent:i.cname},[$t,t("div",Ct,[t("span",St,ie(i.cname),1)])],8,kt)]))),128))])],4))}}),It=ue(Pt,[["__scopeId","data-v-e40a1a75"]]),y=d=>(re("data-v-a5739f31"),d=d(),de(),d),Gt={class:"flex justify-between align-items-center bg-blue-600 text-white"},Et={class:"ml-4 flex-1"},Nt={class:"m-1"},Dt=y(()=>t("i",{class:"fa fa-arrow-circle-right","aria-hidden":"true"},null,-1)),Vt=[Dt],qt={key:0},Ft=y(()=>t("i",{class:"fa fa-solid fa-plus text-white size-6 justify-center mt-2"},null,-1)),Ot=y(()=>t("span",{class:"text-white"},"Increase Grid",-1)),Bt={class:"flex justify-between align-items-center"},zt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-fire"})],-1)),Lt=[zt],Tt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-circle-info"})],-1)),jt=[Tt],At=y(()=>t("span",null,[t("i",{class:"fa-solid fa-eye"})],-1)),Ht=[At],Mt=y(()=>t("div",null,"Loading...",-1)),Rt=y(()=>t("div",{class:"flex flex-col justify-end align-items-center mb-5"},[t("div")],-1)),Jt=B({__name:"GridStackCreate",async setup(d,{expose:m}){let g,S;const a=_([]),i=_([]),c=_(Xe()),$=_(!1),x=Ee(),P=Ne(),z=s=>e=>{e&&(i.value[s]||(i.value[s]=e))},E=De(Je.gsPageConfigOptions,!1),pe=async()=>{let s=!1;if(E){const{importConfiged:e}=Qe();try{s=await e(E)}catch{}}},N=([g,S]=Ve(()=>pe()),g=await g,S(),g),{savePage:_e,getPageById:ve}=N?N.layoutStore():Ye(),M=N?N.eventHandler():Me(),L=async(s,e,o)=>await Ce(s,e,o);M.fns.invoke=L;const me=qe({...M});Fe("__page_handlers",me);const I=_(!1),ge=()=>{I.value=!I.value},he=()=>{I.value=!I.value},D=_(300),ye=()=>{D.value=300},xe=()=>{D.value=0},C=_({float:!1,compact:!1}),R=_(!1),J=_([]);ne(async()=>{if(x.params.id&&x.fullPath.match(/\/page\/w/))await W();else if(x.params.id&&x.fullPath.match(/\/page\/b\/w/))await we();else{const s=c.value.grids||[];a.value=s.map(e=>e.id),a.value.length==0&&Z()}}),Oe(()=>{});const T=async s=>{i.value.forEach((e,o)=>{if(e){const p=s[o];e.load(p.items)}else e.load({id:1,x:2,y:1,h:2})})},we=async()=>{let s=localStorage.getItem(x.params.id);if(s){c.value=JSON.parse(se.decode(s));const e=c.value.grids;a.value=e.map(o=>o.id),q(async()=>{await T(e)})}},W=async()=>{let s=x.params.id;s||(s=c.value.id),c.value=await ve(s),a.value=c.value.grids.map(e=>e.id),q(async()=>{await T(c.value.grids)})},j=async(s=!1)=>{const e=Array();i.value.forEach((o,p)=>{o&&e.push({id:a.value[p],items:o.save()})}),c.value.grids=e,await _e(c.value),s||O.success("Saved successfully!")},U=async()=>{i.value.forEach((s,e)=>{s&&s.clear()})},K=async()=>{const s=c.value.id;let e=se.encode(JSON.stringify(X()));localStorage.setItem(s,e),P.push({name:"preview",params:{id:s}})},Q=async()=>{c.value.status="published",await j(!0),O.success("Published successfully!"),setTimeout(()=>{const s=c.value.id;P.push({name:"page",params:{id:s}})},1e3)},be=()=>{P.push({name:"pagelist"})};Be(C.value,()=>{i.value.forEach((s,e)=>{s&&(s.float(C.value.float),C.value.compact&&s.compact(C.value.compact))})},{deep:!0});const X=()=>{const s=Array();i.value.forEach((o,p)=>{o&&s.push({id:a.value[p],items:o.save()})});const e=JSON.parse(JSON.stringify(c.value));return e.grids=s,e},Y=()=>{J.value=X(),R.value=!0},Z=()=>{const s=Ze();a.value.push(s.id),q(()=>{})},ke=async s=>{if(a.value.length==1)O.error("Only one grid in the layout, ignore delete!");else if(a.value.find(e=>e==s))try{const e=a.value.findIndex(o=>o==s);if(e==a.value.length-1){const o=i.value[e];o.clear(),o.destroyGrid(s),a.value.splice(e,1),q(async()=>{const p=i.value.splice(0,i.value.length);a.value.forEach(u=>{const w=p.find(V=>V.props.id==u);i.value.push(w)})})}}catch{O.error("Grid deleted from layout error: "+s)}},$e=(s,e)=>i.value.map(o=>o.findCompFn(s,e)).flatMap(o=>o),Ce=async(s,e,o)=>{const p=$e(s,e).map(u=>{let w=u.f(e,o);return w instanceof Promise?w:Promise.resolve(w)});return await Promise.all(p).then(u=>Promise.resolve(u))},Se=async()=>{(await L("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return m({showInfo:Y,load:T,save:j,clear:U,preview:K,publish:Q,invoke:L}),(s,e)=>{const o=ze,p=Le,u=Te,w=je,V=ae,G=Ae,Pe=He,Ie=oe;return r(),v(H,null,[l(It,{"pannel-width":D.value,publish:Q,save:j,load:W,clear:U,close:xe},null,8,["pannel-width"]),t("div",Gt,[t("div",Et,[t("h1",Nt,[t("button",{class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white",onClick:f(ye,["prevent"])},Vt),l(u,{class:"ml-64 text-lg font-bold"},{default:n(()=>[I.value?(r(),b(o,{key:1,onChange:he,style:{width:"320px"},modelValue:c.value.title,"onUpdate:modelValue":e[0]||(e[0]=h=>c.value.title=h)},null,8,["modelValue"])):(r(),v("span",qt,ie(c.value.title),1)),l(p,{class:"size-5 cursor-pointer",onClick:f(ge,["prevent"])})]),_:1}),l(u,{class:"mx-8 text-lg"},{default:n(()=>[A(" Compact "),l(w,{class:"mx-3",modelValue:C.value.compact,"onUpdate:modelValue":e[1]||(e[1]=h=>C.value.compact=h),"checked-color":"#14C9C9","unchecked-color":"lightgray"},null,8,["modelValue"])]),_:1}),$.value?F("",!0):(r(),b(u,{key:0,class:"mx-3 text-2xl font-bold",onClick:e[2]||(e[2]=f(h=>Z(),["prevent"]))},{default:n(()=>[l(G,{content:"Add a grid into layout"},{default:n(()=>[l(V,{type:"outline"},{icon:n(()=>[Ft]),default:n(()=>[Ot]),_:1})]),_:1})]),_:1}))])]),t("div",Bt,[l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"just for test"},{default:n(()=>[t("button",{onClick:e[3]||(e[3]=f(h=>Se(),["prevent"]))},Lt)]),_:1})]),_:1}),l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Show page info"},{default:n(()=>[t("button",{onClick:f(Y,["prevent"])},jt)]),_:1}),l(Re,{show:R.value,items:J.value},null,8,["show","items"])]),_:1}),l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Page Preview"},{default:n(()=>[$.value?F("",!0):(r(),v("button",{key:0,onClick:e[4]||(e[4]=f(h=>K(),["prevent"]))},Ht))]),_:1})]),_:1}),$.value?F("",!0):(r(),b(u,{key:0,class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Exit page design"},{default:n(()=>[l(Ie,{content:"Are you sure you want to exit ",type:"info",onOk:be},{default:n(()=>[l(V,{type:"outline",status:"warning",style:{"font-weight":"600"}},{icon:n(()=>[l(Pe,{size:"18"})]),default:n(()=>[A("Exit Design")]),_:1})]),_:1})]),_:1})]),_:1}))])]),t("div",{class:"page-create",style:ce({marginLeft:D.value+"px"})},[(r(!0),v(H,null,le(a.value,(h,ee)=>(r(),v("div",null,[(r(),b(fe,null,{fallback:n(()=>[Mt]),default:n(()=>[(r(),b(Ke,{id:h,ref_for:!0,ref:z(ee),pageProps:c.value,pageStatic:$.value,key:h},{menu:n(()=>[$.value?F("",!0):(r(),b(at,{key:0,"grid-id":h,"last-grid":ee==a.value.length-1&&a.value.length>1,"onGrid:remove":ke},null,8,["grid-id","last-grid"]))]),_:2},1032,["id","pageProps","pageStatic"]))]),_:2},1024))]))),256)),Rt],4)],64)}}}),Wt=ue(Jt,[["__scopeId","data-v-a5739f31"]]),ts=B({__name:"DefaultGsPageCreate",setup(d){return(m,g)=>(r(),b(fe,null,{default:n(()=>[l(te(We),{config:te(Ue)},{default:n(()=>[l(Wt)]),_:1},8,["config"])]),_:1}))}});export{ts as default};
