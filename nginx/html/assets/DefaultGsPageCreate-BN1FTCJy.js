import{d as B,r as _,i as r,a as v,w as f,b as t,e as l,k as n,s as A,E as Ie,B as se,P as ae,o as oe,F as H,g as ne,t as le,J as ie,p as ce,l as re,_ as de,u as Ge,h as Ee,K as Ne,N as De,m as Ve,Q as qe,R as Fe,n as q,q as Oe,j as b,f as F,S as ue,T as O,v as Be,I as ze,C as Le,U as Te,V as je,W as Ae,X as He}from"./index-BoDZPnbd.js";import{u as Me,_ as Re,e as Je,G as We}from"./DefaultHandler-CyyKoGVj.js";/* empty css              *//* empty css              */import{g as te,_ as Ue,u as Ke}from"./base64-BRua9_tT.js";import{c as Qe,u as Xe,a as Ye}from"./DefaultLayoutStore-D8wf71kO.js";const Ze={class:"absolute top-1 right-1 text-xl"},et={key:1,class:"flex flex-col"},tt={class:"size-30"},st=B({__name:"GridMenu",props:{gridId:{type:String,required:!0},lastGrid:{type:Boolean,default:!1}},emits:["grid:remove"],setup(d,{emit:m}){const g=d,S=m,a=_(!1),i=()=>{a.value=!a.value},c=()=>{S("grid:remove",g.gridId),a.value=!a.value};return($,x)=>{const P=Ie,z=se,E=ae;return r(),v("div",Ze,[a.value?(r(),v("div",et,[t("div",tt,[l(E,{content:"Are you sure you want to delete grid ",type:"info",onOk:c},{default:n(()=>[l(z,{type:"secondary",class:"text-lg",disabled:!d.lastGrid},{default:n(()=>[l(P),A("Delete")]),_:1},8,["disabled"])]),_:1})])])):(r(),v("i",{key:0,class:"fa-solid fa-pen-to-square grid-menu",onClick:f(i,["prevent"])}))])}}}),at=[{cname:"arcoform",icon:"<i class='fa fa-solid fa-plus'></i>"},{cname:"formexample",icon:"<i class='fa fa-solid fa-plus'></i>"}],k=d=>(ce("data-v-e40a1a75"),d=d(),re(),d),ot={class:"flex"},nt={class:"flex-none"},lt=k(()=>t("i",{class:"fa fa-solid fa-square-share-nodes"},null,-1)),it=[lt],ct={class:"flex-initial"},rt=k(()=>t("i",{class:"fa fa-solid fa-save"},null,-1)),dt=[rt],ut={class:"flex-initial"},ft=k(()=>t("i",{class:"fa fa-solid fa-refresh"},null,-1)),pt=[ft],_t={class:"flex-initial"},vt=k(()=>t("i",{class:"fa fa-solid fa-eraser"},null,-1)),mt=[vt],gt={class:"flex-initial"},ht=k(()=>t("i",{class:"fa fa-solid fa-arrow-left"},null,-1)),yt=[ht],xt=k(()=>t("div",{id:"trash",style:{padding:"5px","margin-bottom":"10px"},class:"text-center text-white bg-amber-400"},[t("div",null,[t("i",{class:"fa fa-solid fa-trash",style:{"font-size":"250%"}})]),t("div",{class:"py-5"},[t("span",null,"Drop here to remove!")])],-1)),wt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 overflow-y-auto"},bt=["gscomponent"],kt=k(()=>t("div",null,[t("i",{class:"fa fa-solid fa-plus",style:{"font-size":"200%"}})],-1)),$t={class:"h-10"},Ct={class:"size-8 my-4"},St=B({__name:"GridStackNaviPanel",props:{pannelWidth:{type:Number,required:!0},publish:{type:Function,required:!0},save:{type:Function,required:!0},load:{type:Function,required:!0},clear:{type:Function,required:!0},close:{type:Function,required:!0}},setup(d){const m=d,g=_([]);return oe(()=>{g.value=at}),(S,a)=>(r(),v("div",{id:"pageSidenav",class:"sidenav",style:ie({width:d.pannelWidth+"px"})},[t("div",ot,[t("div",nt,[t("a",{href:"#",class:"mybtn",onClick:a[0]||(a[0]=f(i=>m.publish(),["prevent"]))},it)]),t("div",ct,[t("a",{href:"#",class:"mybtn",onClick:a[1]||(a[1]=f(i=>m.save(),["prevent"]))},dt)]),t("div",ut,[t("a",{href:"#",class:"mybtn",onClick:a[2]||(a[2]=f(i=>m.load(),["prevent"]))},pt)]),t("div",_t,[t("a",{href:"#",class:"mybtn",onClick:a[3]||(a[3]=f(i=>m.clear(),["prevent"]))},mt)]),t("div",gt,[t("a",{href:"#",class:"mybtn",onClick:a[4]||(a[4]=f(i=>m.close(),["prevent"]))},yt)])]),xt,t("div",wt,[(r(!0),v(H,null,ne(g.value,(i,c)=>(r(),v("div",{key:c,class:"newWidget grid-stack-item grid-custom"},[t("div",{class:"grid-stack-item-content drag",gscomponent:i.cname},[kt,t("div",$t,[t("span",Ct,le(i.cname),1)])],8,bt)]))),128))])],4))}}),Pt=de(St,[["__scopeId","data-v-e40a1a75"]]),y=d=>(ce("data-v-a5739f31"),d=d(),re(),d),It={class:"flex justify-between align-items-center bg-blue-600 text-white"},Gt={class:"ml-4 flex-1"},Et={class:"m-1"},Nt=y(()=>t("i",{class:"fa fa-arrow-circle-right","aria-hidden":"true"},null,-1)),Dt=[Nt],Vt={key:0},qt=y(()=>t("i",{class:"fa fa-solid fa-plus text-white size-6 justify-center mt-2"},null,-1)),Ft=y(()=>t("span",{class:"text-white"},"Increase Grid",-1)),Ot={class:"flex justify-between align-items-center"},Bt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-fire"})],-1)),zt=[Bt],Lt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-circle-info"})],-1)),Tt=[Lt],jt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-eye"})],-1)),At=[jt],Ht=y(()=>t("div",null,"Loading...",-1)),Mt=y(()=>t("div",{class:"flex flex-col justify-end align-items-center mb-5"},[t("div")],-1)),Rt=B({__name:"GridStackCreate",async setup(d,{expose:m}){let g,S;const a=_([]),i=_([]),c=_(Qe()),$=_(!1),x=Ge(),P=Ee(),z=s=>e=>{e&&(i.value[s]||(i.value[s]=e))},E=Ne(Je.gsPageConfigOptions,!1),fe=async()=>{let s=!1;if(E){const{importConfiged:e}=Ke();try{s=await e(E)}catch{}}},N=([g,S]=De(()=>fe()),g=await g,S(),g),{savePage:pe,getPageById:_e}=N?N.layoutStore():Xe(),M=N?N.eventHandler():Me(),L=async(s,e,o)=>await $e(s,e,o);M.fns.invoke=L;const ve=Ve({...M});qe("__page_handlers",ve);const I=_(!1),me=()=>{I.value=!I.value},ge=()=>{I.value=!I.value},D=_(300),he=()=>{D.value=300},ye=()=>{D.value=0},C=_({float:!1,compact:!1}),R=_(!1),J=_([]);oe(async()=>{if(x.params.id&&x.fullPath.match(/\/page\/w/))await W();else if(x.params.id&&x.fullPath.match(/\/page\/b\/w/))await xe();else{const s=c.value.grids||[];a.value=s.map(e=>e.id),a.value.length==0&&Z()}}),Fe(()=>{});const T=async s=>{i.value.forEach((e,o)=>{if(e){const p=s[o];e.load(p.items)}else e.load({id:1,x:2,y:1,h:2})})},xe=async()=>{let s=localStorage.getItem(x.params.id);if(s){c.value=JSON.parse(te.decode(s));const e=c.value.grids;a.value=e.map(o=>o.id),q(async()=>{await T(e)})}},W=async()=>{let s=x.params.id;s||(s=c.value.id),c.value=await _e(s),a.value=c.value.grids.map(e=>e.id),q(async()=>{await T(c.value.grids)})},j=async(s=!1)=>{const e=Array();i.value.forEach((o,p)=>{o&&e.push({id:a.value[p],items:o.save()})}),c.value.grids=e,await pe(c.value),s||O.success("Saved successfully!")},U=async()=>{i.value.forEach((s,e)=>{s&&s.clear()})},K=async()=>{const s=c.value.id;let e=te.encode(JSON.stringify(X()));localStorage.setItem(s,e),P.push({name:"preview",params:{id:s}})},Q=async()=>{c.value.status="published",await j(!0),O.success("Published successfully!"),setTimeout(()=>{const s=c.value.id;P.push({name:"page",params:{id:s}})},1e3)},we=()=>{P.push({name:"pagelist"})};Oe(C.value,()=>{i.value.forEach((s,e)=>{s&&(s.float(C.value.float),C.value.compact&&s.compact(C.value.compact))})},{deep:!0});const X=()=>{const s=Array();i.value.forEach((o,p)=>{o&&s.push({id:a.value[p],items:o.save()})});const e=JSON.parse(JSON.stringify(c.value));return e.grids=s,e},Y=()=>{J.value=X(),R.value=!0},Z=()=>{const s=Ye();a.value.push(s.id),q(()=>{})},be=async s=>{if(a.value.length==1)O.error("Only one grid in the layout, ignore delete!");else if(a.value.find(e=>e==s))try{const e=a.value.findIndex(o=>o==s);if(e==a.value.length-1){const o=i.value[e];o.clear(),o.destroyGrid(s),a.value.splice(e,1),q(async()=>{const p=i.value.splice(0,i.value.length);a.value.forEach(u=>{const w=p.find(V=>V.props.id==u);i.value.push(w)})})}}catch{O.error("Grid deleted from layout error: "+s)}},ke=(s,e)=>i.value.map(o=>o.findCompFn(s,e)).flatMap(o=>o),$e=async(s,e,o)=>{const p=ke(s,e).map(u=>{let w=u.f(e,o);return w instanceof Promise?w:Promise.resolve(w)});return await Promise.all(p).then(u=>Promise.resolve(u))},Ce=async()=>{(await L("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return m({showInfo:Y,load:T,save:j,clear:U,preview:K,publish:Q,invoke:L}),(s,e)=>{const o=Be,p=ze,u=Le,w=Te,V=se,G=je,Se=Ae,Pe=ae;return r(),v(H,null,[l(Pt,{"pannel-width":D.value,publish:Q,save:j,load:W,clear:U,close:ye},null,8,["pannel-width"]),t("div",It,[t("div",Gt,[t("h1",Et,[t("button",{class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white",onClick:f(he,["prevent"])},Dt),l(u,{class:"ml-64 text-lg font-bold"},{default:n(()=>[I.value?(r(),b(o,{key:1,onChange:ge,style:{width:"320px"},modelValue:c.value.title,"onUpdate:modelValue":e[0]||(e[0]=h=>c.value.title=h)},null,8,["modelValue"])):(r(),v("span",Vt,le(c.value.title),1)),l(p,{class:"size-5 cursor-pointer",onClick:f(me,["prevent"])})]),_:1}),l(u,{class:"mx-8 text-lg"},{default:n(()=>[A(" Compact "),l(w,{class:"mx-3",modelValue:C.value.compact,"onUpdate:modelValue":e[1]||(e[1]=h=>C.value.compact=h),"checked-color":"#14C9C9","unchecked-color":"lightgray"},null,8,["modelValue"])]),_:1}),$.value?F("",!0):(r(),b(u,{key:0,class:"mx-3 text-2xl font-bold",onClick:e[2]||(e[2]=f(h=>Z(),["prevent"]))},{default:n(()=>[l(G,{content:"Add a grid into layout"},{default:n(()=>[l(V,{type:"outline"},{icon:n(()=>[qt]),default:n(()=>[Ft]),_:1})]),_:1})]),_:1}))])]),t("div",Ot,[l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"just for test"},{default:n(()=>[t("button",{onClick:e[3]||(e[3]=f(h=>Ce(),["prevent"]))},zt)]),_:1})]),_:1}),l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Show page info"},{default:n(()=>[t("button",{onClick:f(Y,["prevent"])},Tt)]),_:1}),l(Re,{show:R.value,items:J.value},null,8,["show","items"])]),_:1}),l(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Page Preview"},{default:n(()=>[$.value?F("",!0):(r(),v("button",{key:0,onClick:e[4]||(e[4]=f(h=>K(),["prevent"]))},At))]),_:1})]),_:1}),$.value?F("",!0):(r(),b(u,{key:0,class:"mx-3 text-2xl font-bold"},{default:n(()=>[l(G,{content:"Exit page design"},{default:n(()=>[l(Pe,{content:"Are you sure you want to exit ",type:"info",onOk:we},{default:n(()=>[l(V,{type:"outline",status:"warning",style:{"font-weight":"600"}},{icon:n(()=>[l(Se,{size:"18"})]),default:n(()=>[A("Exit Design")]),_:1})]),_:1})]),_:1})]),_:1}))])]),t("div",{class:"page-create",style:ie({marginLeft:D.value+"px"})},[(r(!0),v(H,null,ne(a.value,(h,ee)=>(r(),v("div",null,[(r(),b(ue,null,{fallback:n(()=>[Ht]),default:n(()=>[(r(),b(Ue,{id:h,ref_for:!0,ref:z(ee),pageProps:c.value,pageStatic:$.value,key:h},{menu:n(()=>[$.value?F("",!0):(r(),b(st,{key:0,"grid-id":h,"last-grid":ee==a.value.length-1&&a.value.length>1,"onGrid:remove":be},null,8,["grid-id","last-grid"]))]),_:2},1032,["id","pageProps","pageStatic"]))]),_:2},1024))]))),256)),Mt],4)],64)}}}),Jt=de(Rt,[["__scopeId","data-v-a5739f31"]]),Zt=B({__name:"DefaultGsPageCreate",setup(d){return(m,g)=>(r(),b(ue,null,{default:n(()=>[l(He(We),{"config-file":"../dynamic/stack.config"},{default:n(()=>[l(Jt)]),_:1})]),_:1}))}});export{Zt as default};
