import{d as B,r as _,i as r,a as v,w as p,b as t,e as i,k as n,s as A,E as Ie,B as ae,P as oe,o as ne,F as M,g as le,t as ie,J as ce,p as re,l as de,_ as ue,u as Ge,h as Ee,K as Ne,N as De,m as Ve,Q as qe,R as Fe,n as q,q as Oe,j as k,f as F,S as pe,T as O,v as Be,I as ze,C as Te,U as je,V as Le,W as Ae,X as te}from"./index-CoFw7xk0.js";import{u as Me,_ as Re,e as He,a as Je,G as We}from"./DynamicLoader-y4t8jQNW.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{a as Ue,g as se,_ as Ke}from"./base64-iVB-2yUr.js";import{c as Qe,u as Xe,a as Ye}from"./DefaultLayoutStore-D8eKRoAA.js";import{c as Ze}from"./stack.config-BQiGw8a2.js";/* empty css              */const et={class:"absolute top-1 right-1 text-xl"},tt={key:1,class:"flex flex-col"},st={class:"size-30"},at=B({__name:"GridMenu",props:{gridId:{type:String,required:!0},lastGrid:{type:Boolean,default:!1}},emits:["grid:remove"],setup(d,{emit:m}){const h=d,x=m,a=_(!1),l=()=>{a.value=!a.value},c=()=>{x("grid:remove",h.gridId),a.value=!a.value};return(C,w)=>{const P=Ie,z=ae,N=oe;return r(),v("div",et,[a.value?(r(),v("div",tt,[t("div",st,[i(N,{content:"Are you sure you want to delete grid ",type:"info",onOk:c},{default:n(()=>[i(z,{type:"secondary",class:"text-lg",disabled:!d.lastGrid},{default:n(()=>[i(P),A("Delete")]),_:1},8,["disabled"])]),_:1})])])):(r(),v("i",{key:0,class:"fa-solid fa-pen-to-square grid-menu",onClick:p(l,["prevent"])}))])}}}),$=d=>(re("data-v-2d19785d"),d=d(),de(),d),ot={class:"flex"},nt={class:"flex-none"},lt=$(()=>t("i",{class:"fa fa-solid fa-square-share-nodes"},null,-1)),it=[lt],ct={class:"flex-initial"},rt=$(()=>t("i",{class:"fa fa-solid fa-save"},null,-1)),dt=[rt],ut={class:"flex-initial"},pt=$(()=>t("i",{class:"fa fa-solid fa-refresh"},null,-1)),ft=[pt],_t={class:"flex-initial"},vt=$(()=>t("i",{class:"fa fa-solid fa-eraser"},null,-1)),mt=[vt],ht={class:"flex-initial"},gt=$(()=>t("i",{class:"fa fa-solid fa-arrow-left"},null,-1)),yt=[gt],xt=$(()=>t("div",{id:"trash",style:{padding:"5px","margin-bottom":"10px"},class:"text-center text-white bg-amber-400"},[t("div",null,[t("i",{class:"fa fa-solid fa-trash",style:{"font-size":"250%"}})]),t("div",{class:"py-5"},[t("span",null,"Drop here to remove!")])],-1)),wt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 overflow-y-auto"},bt=["gscomponent"],kt=$(()=>t("div",null,[t("i",{class:"fa fa-solid fa-plus",style:{"font-size":"200%"}})],-1)),$t={class:"h-10"},Ct={class:"size-8 my-4"},St=B({__name:"GridStackNaviPanel",props:{pannelWidth:{type:Number,required:!0},publish:{type:Function,required:!0},save:{type:Function,required:!0},load:{type:Function,required:!0},clear:{type:Function,required:!0},close:{type:Function,required:!0}},setup(d){const m=d,h=_([]);return ne(()=>{h.value=Ue.map(x=>x.props)}),(x,a)=>(r(),v("div",{id:"pageSidenav",class:"sidenav",style:ce({width:d.pannelWidth+"px"})},[t("div",ot,[t("div",nt,[t("a",{href:"#",class:"mybtn",onClick:a[0]||(a[0]=p(l=>m.publish(),["prevent"]))},it)]),t("div",ct,[t("a",{href:"#",class:"mybtn",onClick:a[1]||(a[1]=p(l=>m.save(),["prevent"]))},dt)]),t("div",ut,[t("a",{href:"#",class:"mybtn",onClick:a[2]||(a[2]=p(l=>m.load(),["prevent"]))},ft)]),t("div",_t,[t("a",{href:"#",class:"mybtn",onClick:a[3]||(a[3]=p(l=>m.clear(),["prevent"]))},mt)]),t("div",ht,[t("a",{href:"#",class:"mybtn",onClick:a[4]||(a[4]=p(l=>m.close(),["prevent"]))},yt)])]),xt,t("div",wt,[(r(!0),v(M,null,le(h.value,(l,c)=>(r(),v("div",{key:c,class:"newWidget grid-stack-item grid-custom"},[t("div",{class:"grid-stack-item-content drag",gscomponent:l.cname},[kt,t("div",$t,[t("span",Ct,ie(l.description||l.cname),1)])],8,bt)]))),128))])],4))}}),Pt=ue(St,[["__scopeId","data-v-2d19785d"]]),y=d=>(re("data-v-6d46ede4"),d=d(),de(),d),It={class:"flex justify-between align-items-center bg-blue-600 text-white"},Gt={class:"ml-4 flex-1"},Et={class:"m-1"},Nt=y(()=>t("i",{class:"fa fa-arrow-circle-right","aria-hidden":"true"},null,-1)),Dt=[Nt],Vt={key:0},qt=y(()=>t("i",{class:"fa fa-solid fa-plus text-white size-6 justify-center mt-2"},null,-1)),Ft=y(()=>t("span",{class:"text-white"},"Increase Grid",-1)),Ot={class:"flex justify-between align-items-center"},Bt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-fire"})],-1)),zt=[Bt],Tt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-circle-info"})],-1)),jt=[Tt],Lt=y(()=>t("span",null,[t("i",{class:"fa-solid fa-eye"})],-1)),At=[Lt],Mt=y(()=>t("div",null,"Loading...",-1)),Rt=y(()=>t("div",{class:"flex flex-col justify-end align-items-center mb-5"},[t("div")],-1)),Ht=B({__name:"GridStackCreate",async setup(d,{expose:m}){let h,x;const a=_([]),l=_([]),c=_(Qe()),C=_(!1),w=Ge(),P=Ee(),z=s=>e=>{e&&(l.value[s]||(l.value[s]=e))},N=Ne(He.gsPageConfigOptions,!1);let I=!1;if(N){const{imports:s}=Je();try{I=([h,x]=De(()=>s(N)),h=await h,x(),h)}catch{}}const{savePage:fe,getPageById:_e}=I?I.layoutStore():Xe(),R=I?I.eventHandler():Me(),T=async(s,e,o)=>await $e(s,e,o);R.fns.invoke=T;const ve=Ve({...R});qe("__page_handlers",ve);const G=_(!1),me=()=>{G.value=!G.value},he=()=>{G.value=!G.value},D=_(300),ge=()=>{D.value=300},ye=()=>{D.value=0},S=_({float:!1,compact:!1}),H=_(!1),J=_([]);ne(async()=>{if(w.params.id&&w.fullPath.match(/\/page\/w/))await W();else if(w.params.id&&w.fullPath.match(/\/page\/b\/w/))await xe();else{const s=c.value.grids||[];a.value=s.map(e=>e.id),a.value.length==0&&Z()}}),Fe(()=>{});const j=async s=>{l.value.forEach((e,o)=>{if(e){const f=s[o];e.load(f.items)}else e.load({id:1,x:2,y:1,h:2})})},xe=async()=>{let s=localStorage.getItem(w.params.id);if(s){c.value=JSON.parse(se.decode(s));const e=c.value.grids;a.value=e.map(o=>o.id),q(async()=>{await j(e)})}},W=async()=>{let s=w.params.id;s||(s=c.value.id),c.value=await _e(s),a.value=c.value.grids.map(e=>e.id),q(async()=>{await j(c.value.grids)})},L=async(s=!1)=>{const e=Array();l.value.forEach((o,f)=>{o&&e.push({id:a.value[f],items:o.save()})}),c.value.grids=e,await fe(c.value),s||O.success("Saved successfully!")},U=async()=>{l.value.forEach((s,e)=>{s&&s.clear()})},K=async()=>{const s=c.value.id;let e=se.encode(JSON.stringify(X()));localStorage.setItem(s,e),P.push({name:"preview",params:{id:s}})},Q=async()=>{c.value.status="published",await L(!0),O.success("Published successfully!"),setTimeout(()=>{const s=c.value.id;P.push({name:"page",params:{id:s}})},1e3)},we=()=>{P.push({name:"pagelist"})};Oe(S.value,()=>{l.value.forEach((s,e)=>{s&&(s.float(S.value.float),S.value.compact&&s.compact(S.value.compact))})},{deep:!0});const X=()=>{const s=Array();l.value.forEach((o,f)=>{o&&s.push({id:a.value[f],items:o.save()})});const e=JSON.parse(JSON.stringify(c.value));return e.grids=s,e},Y=()=>{J.value=X(),H.value=!0},Z=()=>{const s=Ye();a.value.push(s.id),q(()=>{})},be=async s=>{if(a.value.length==1)O.error("Only one grid in the layout, ignore delete!");else if(a.value.find(e=>e==s))try{const e=a.value.findIndex(o=>o==s);if(e==a.value.length-1){const o=l.value[e];o.clear(),o.destroyGrid(s),a.value.splice(e,1),q(async()=>{const f=l.value.splice(0,l.value.length);a.value.forEach(u=>{const b=f.find(V=>V.props.id==u);l.value.push(b)})})}}catch{O.error("Grid deleted from layout error: "+s)}},ke=(s,e)=>l.value.map(o=>o.findCompFn(s,e)).flatMap(o=>o),$e=async(s,e,o)=>{const f=ke(s,e).map(u=>{let b=u.f(e,o);return b instanceof Promise?b:Promise.resolve(b)});return await Promise.all(f).then(u=>Promise.resolve(u))},Ce=async()=>{(await T("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return m({showInfo:Y,load:j,save:L,clear:U,preview:K,publish:Q,invoke:T}),(s,e)=>{const o=Be,f=ze,u=Te,b=je,V=ae,E=Le,Se=Ae,Pe=oe;return r(),v(M,null,[i(Pt,{"pannel-width":D.value,publish:Q,save:L,load:W,clear:U,close:ye},null,8,["pannel-width"]),t("div",It,[t("div",Gt,[t("h1",Et,[t("button",{class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white",onClick:p(ge,["prevent"])},Dt),i(u,{class:"ml-64 text-lg font-bold"},{default:n(()=>[G.value?(r(),k(o,{key:1,onChange:he,style:{width:"320px"},modelValue:c.value.title,"onUpdate:modelValue":e[0]||(e[0]=g=>c.value.title=g)},null,8,["modelValue"])):(r(),v("span",Vt,ie(c.value.title),1)),i(f,{class:"size-5 cursor-pointer",onClick:p(me,["prevent"])})]),_:1}),i(u,{class:"mx-8 text-lg"},{default:n(()=>[A(" Compact "),i(b,{class:"mx-3",modelValue:S.value.compact,"onUpdate:modelValue":e[1]||(e[1]=g=>S.value.compact=g),"checked-color":"#14C9C9","unchecked-color":"lightgray"},null,8,["modelValue"])]),_:1}),C.value?F("",!0):(r(),k(u,{key:0,class:"mx-3 text-2xl font-bold",onClick:e[2]||(e[2]=p(g=>Z(),["prevent"]))},{default:n(()=>[i(E,{content:"Add a grid into layout"},{default:n(()=>[i(V,{type:"outline"},{icon:n(()=>[qt]),default:n(()=>[Ft]),_:1})]),_:1})]),_:1}))])]),t("div",Ot,[i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(E,{content:"just for test"},{default:n(()=>[t("button",{onClick:e[3]||(e[3]=p(g=>Ce(),["prevent"]))},zt)]),_:1})]),_:1}),i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(E,{content:"Show page info"},{default:n(()=>[t("button",{onClick:p(Y,["prevent"])},jt)]),_:1}),i(Re,{show:H.value,items:J.value},null,8,["show","items"])]),_:1}),i(u,{class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(E,{content:"Page Preview"},{default:n(()=>[C.value?F("",!0):(r(),v("button",{key:0,onClick:e[4]||(e[4]=p(g=>K(),["prevent"]))},At))]),_:1})]),_:1}),C.value?F("",!0):(r(),k(u,{key:0,class:"mx-3 text-2xl font-bold"},{default:n(()=>[i(E,{content:"Exit page design"},{default:n(()=>[i(Pe,{content:"Are you sure you want to exit ",type:"info",onOk:we},{default:n(()=>[i(V,{type:"outline",status:"warning",style:{"font-weight":"600"}},{icon:n(()=>[i(Se,{size:"18"})]),default:n(()=>[A("Exit Design")]),_:1})]),_:1})]),_:1})]),_:1}))])]),t("div",{class:"page-create",style:ce({marginLeft:D.value+"px"})},[(r(!0),v(M,null,le(a.value,(g,ee)=>(r(),v("div",null,[(r(),k(pe,null,{fallback:n(()=>[Mt]),default:n(()=>[(r(),k(Ke,{id:g,ref_for:!0,ref:z(ee),pageProps:c.value,pageStatic:C.value,key:g},{menu:n(()=>[C.value?F("",!0):(r(),k(at,{key:0,"grid-id":g,"last-grid":ee==a.value.length-1&&a.value.length>1,"onGrid:remove":be},null,8,["grid-id","last-grid"]))]),_:2},1032,["id","pageProps","pageStatic"]))]),_:2},1024))]))),256)),Rt],4)],64)}}}),Jt=ue(Ht,[["__scopeId","data-v-6d46ede4"]]),ns=B({__name:"DefaultGsPageCreate",setup(d){return(m,h)=>(r(),k(pe,null,{default:n(()=>[i(te(We),{config:te(Ze)},{default:n(()=>[i(Jt)]),_:1},8,["config"])]),_:1}))}});export{ns as default};
