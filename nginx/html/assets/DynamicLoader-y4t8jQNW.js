import{d as D,Y as T,Z as O,Q as H,r as L,q as G,i as F,j as V,k as _,s as j,e as $,$ as k,C as M,M as J,a0 as z,m as w}from"./index-CoFw7xk0.js";/* empty css              *//* empty css              *//* empty css              */import{b as g,v as q,w as Q,d as C,u as W}from"./DefaultLayoutStore-D8eKRoAA.js";const U=e=>({options:{eventHandler:(e==null?void 0:e.eventHandler)??"DefaultHandler",layoutStore:(e==null?void 0:e.layoutStore)??"DefaultLayoutStore",dataStore:(e==null?void 0:e.dataStore)??"DefaultDataStore"}}),Y=Object.freeze(Object.defineProperty({__proto__:null,defaultConfig:U},Symbol.toStringTag,{value:"Module"})),A={gsPageHandler:"__gs_page_handler",gsPageConfigOptions:"__gs_page_config_options__",gsPageConfig:"__gs_page_config__"};function Z(e){const t=Object.assign({alias:"GridLayoutConfig"},typeof e=="function"?e():e);console.log("***options",t);const a=U(t.config||{}).options;t.config={rootConfig:a},H(A.gsPageConfigOptions,t),H(A.gsPageConfig,a)}const K=D(function(t,{slots:a,attrs:s}){const i={};return t.config&&Z(t.config),()=>a.default?a.default(i).map(r=>T(r,{...s,...r.props})):null},{props:["config"],name:"GridLayoutProvider",inheritAttrs:!1}),Ce=D(async function(t,a){let s={};if(t.configFile){const r=await import(t.configFile);s="default"in r?r.default:r}if(console.log("config",s),typeof s=="function"&&(s=s()),t.defaultConfig??!0){const{defaultConfig:r}=await O(async()=>{const{defaultConfig:c}=await Promise.resolve().then(()=>Y);return{defaultConfig:c}},[]);s=r(s).options}return console.log("now config",s),()=>T(K,{...a.attrs,config:s},a.slots)},{props:["defaultConfig","configFile"],inheritAttrs:!1}),ve=D({__name:"PageInfoDialog",props:{show:{type:Boolean,default:!1},items:{type:Object,default:[]}},setup(e){const t=e,a=L(!1),s=L("");G(t,()=>{a.value=t.show,s.value=JSON.stringify(t.items||[],null,"  ")});const i=async()=>{a.value=!1};return(r,c)=>{const h=k,o=M,n=J;return F(),V(n,{visible:a.value,"onUpdate:visible":c[1]||(c[1]=d=>a.value=d),onOk:i,draggable:"","unmount-on-close":"","hide-cancel":!0},{title:_(()=>[j(" Page Layout Info ")]),default:_(()=>[$(o,{direction:"vertical",size:"large",fill:""},{default:_(()=>[$(h,{modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=d=>s.value=d),class:"h-80","allow-clear":"","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["visible"])}}}),y=`${Q}/comp_data`,R=z("defaultDataStore",{state:()=>({dataList:[]}),getters:{get:e=>t=>e.dataList.find(a=>a.id===t)},actions:{async getDataList(){return await g.get(`${y}`).then(e=>(this.dataList=e.data,e.data)).catch(e=>(console.log(e),!1))},async getDataById(e){return await g.get(`${y}/${e}`).then(t=>t.data).catch(t=>(console.log(t),!1))},async getDataByName(e){return await g.get(`${y}?cname=${e}`).then(t=>t.data).catch(t=>(console.log(t),!1))},async getDataByCid(e){return await g.get(`${y}?cid=${e}`).then(t=>t.data).catch(t=>(console.log(t),!1))},async getDataByAliasName(e){return await g.get(`${y}?cname=${e}`).then(t=>t.data).catch(t=>(console.log(t),!1))},async exists(e){return await this.getDataById(e)!=null},async saveData(e,t,a){try{return!e.id||!await this.exists(e.id)?await this.insertData(e,t,a):await this.updateData(e,t,a)}catch{return!1}},async insertData(e,t,a){const s="POST";e.id||(e.id=q()),a&&(e.cname=a),t&&(e.cid=t);const i=JSON.stringify(e),r=C;return await g.post(`${y}`,i,{method:s,headers:r}).then(c=>c.data).catch(c=>(console.log(c),!1))},async updateData(e,t,a){const s="PUT";a&&(e.cname=a),t&&(e.cid=t);const i=JSON.stringify(e),r=C;return await g.patch(`${y}/${e.id}`,i,{method:s,headers:r}).then(c=>c.data).catch(c=>(console.log(c),!1))},async deleteData(e){const t="DELETE",a=C;return await g.delete(`${y}/${e}`,{method:t,headers:a}).then(s=>s.data).catch(s=>(console.log(s),!1))}}}),x=()=>{const e={...R()},t=e.getDataById,a=async s=>(console.log("****This is TestDataStore GetDataById "),await t(s));return e.getDataById=a,{...e}},B=(e,t,a,s,i,r)=>{const{getDataById:c,getDataByName:h,getDataByCid:o,getDataList:n,saveData:d,deleteData:f}=x(),m=w({invoke:(l,u,p)=>{}});return{loadHandler:e||(async(l,u)=>{if(console.log("default loadHandler event called",l.data),l.data.id){const p=await c(l.data.id);u&&u(p)}}),saveHandler:t||(async(l,u)=>{console.log("default saveHandler event called",l.data),l.data.cname=l.cname,l.data.aliasName=l.aliasName;const p=await d(l.data,l.cid);u&&u(p)}),itemChangedHandler:a||(async(l,u)=>{console.log("default itemChangedHandler event received: ",l.cid,l.data),u&&u(!0)}),deleteHandler:s||(async(l,u)=>{console.log("default deleteHandler event called",l.data);const p=await f(l.data.id);u&&u(p)}),uploadHandler:i||((l,u)=>{console.log("default uploadHandler event called",l.data),u&&u(!0)}),callHandler:r||((l,u)=>{console.log("default optionHandler event called",l.data),u&&u(!0)}),invoke:async(l,u,p)=>{if(m.invoke)return await m.invoke(l,u,p)},fns:m}},I=w([{name:"DefaultDataStore",store:R},{name:"DefaultLayoutStore",store:W},{name:"TestDataStore",store:x}]),X=()=>{const e={...B()},t=e.saveHandler;return e.saveHandler=(a,s)=>{console.log("****This is a override save handler"),t(a,s)},{...e}},ee=w([{name:"DefaultHandler",handler:B},{name:"TestHandler",handler:X}]),te=/[\p{Lu}]/u,ae=/[\p{Ll}]/u,E=/^[\p{Lu}](?![\p{Lu}])/gu,b=/([\p{Alpha}\p{N}_]|$)/u,S=/[_.\- ]+/,oe=new RegExp("^"+S.source),P=new RegExp(S.source+b.source,"gu"),N=new RegExp("\\d+"+b.source,"gu"),se=(e,t,a,s)=>{let i=!1,r=!1,c=!1,h=!1;for(let o=0;o<e.length;o++){const n=e[o];h=o>2?e[o-3]==="-":!0,i&&te.test(n)?(e=e.slice(0,o)+"-"+e.slice(o),i=!1,c=r,r=!0,o++):r&&c&&ae.test(n)&&(!h||s)?(e=e.slice(0,o-1)+"-"+e.slice(o-1),c=r,r=!1,i=!0):(i=t(n)===n&&a(n)!==n,c=r,r=a(n)===n&&t(n)!==n)}return e},ne=(e,t)=>(E.lastIndex=0,e.replaceAll(E,a=>t(a))),re=(e,t)=>(P.lastIndex=0,N.lastIndex=0,e.replaceAll(N,(a,s,i)=>["_","-"].includes(e.charAt(i+a.length))?a:t(a)).replaceAll(P,(a,s)=>t(s)));function v(e,t){if(!(typeof e=="string"||Array.isArray(e)))throw new TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},Array.isArray(e)?e=e.map(r=>r.trim()).filter(r=>r.length).join("-"):e=e.trim(),e.length===0)return"";const a=t.locale===!1?r=>r.toLowerCase():r=>r.toLocaleLowerCase(t.locale),s=t.locale===!1?r=>r.toUpperCase():r=>r.toLocaleUpperCase(t.locale);return e.length===1?S.test(e)?"":t.pascalCase?s(e):a(e):(e!==a(e)&&(e=se(e,a,s,t.preserveConsecutiveUppercase)),e=e.replace(oe,""),e=t.preserveConsecutiveUppercase?ne(e,a):a(e),t.pascalCase&&(e=s(e.charAt(0))+e.slice(1)),re(e,s))}function De(){const e={handler:"../dynamic/handlers",store:"../dynamic/store",component:"../dynamic/component"};async function t(o,n,d="ts"){try{const f=await O(()=>import(`${o}/${n}.${d}`),[]);return console.log("load module: ",f),f.default?f.default:f}catch(f){return console.error(`Failed to load module: ${o}/${n}`,f),!1}}const a=async o=>{if(o){const n=v(`use_${o.eventHandler}`),d=await t(e.handler,o.eventHandler);if(d!==!1){if(n in d)return d[n];console.warn(`Not found handler ${n} in ${o.eventHandler}.ts`)}}return!1},s=async o=>{if(o){const n=v(`use_${o.dataStore}`),d=await t(e.store,o.dataStore);if(d!==!1){if(n in d)return d[n];console.warn(`Not found data store ${n} in ${o.dataStore}.ts`)}}return!1},i=async o=>{if(o){const n=v(`use_${o.layoutStore}`),d=await t(e.store,o.layoutStore);if(d!==!1){if(n in d)return d[n];console.warn(`Not found layout store ${n} in ${o.layoutStore}.ts`)}}return!1};return{importLayoutStore:i,importHandler:a,importComponent:async o=>{const n=await t(e.component,o);return n===!1?(console.warn(`Not found component ${o}.ts file`),!1):"component"in n&&"props"in n?[n.component,n.props]:(console.warn(`No function component or props in ${o}.ts file`),!1)},loadModule:t,importDataStore:s,importConfiged:async o=>({eventHandler:await a(o),layoutStore:await i(o),dataStore:await s(o)}),imports:async o=>{var n,d,f;return{eventHandler:(n=ee.find(m=>m.name==o.eventHandler))==null?void 0:n.handler,layoutStore:(d=I.find(m=>m.name==o.layoutStore))==null?void 0:d.store,dataStore:(f=I.find(m=>m.name==o.dataStore))==null?void 0:f.store}}}}export{K as G,ve as _,De as a,Ce as b,A as e,B as u};
