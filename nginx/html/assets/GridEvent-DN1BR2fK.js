import{d as C,r as E,o as G,h as q,a as u,t as N,w as B,b as m,e as g,f as d,g as $,x as L,K as P}from"./index-wkNrGTcD.js";import{G as f,a as x}from"./GridStackItem-DslgcUYb.js";import{v as c}from"./v4-DvF23Exx.js";const D={class:"full-w p-1 page"},M=["id"],O={key:0,class:"drag-to-here"},V=d("hr",null,null,-1),W=d("div",null,null,-1),j=C({__name:"GridStackMultiLayout",props:{id:{type:String,required:!0},pageProps:{type:Object,required:!0},pageStatic:{type:Boolean,required:!0}},setup(e,{expose:y}){const h=E(null),r=e;var t=null;G(async()=>{let n=document.getElementById(r.id)||document.querySelector(".grid-stack");t=f.init({float:!0,cellHeight:"25",minRow:5,acceptWidgets:!0,removable:"#trash",columnOpts:{breakpointForWindow:!0,breakpoints:[{w:700,c:1},{w:850,c:3},{w:950,c:6},{w:1100,c:8}]}},n),t.setStatic(r.pageStatic??!1),f.setupDragIn(".newWidget",{appendTo:"body",helper:"clone"}),t.opts.columnOpts.layout="list",t.on("added",function(i,s){for(const a of s){const o=a.el,l=o.querySelector(".grid-stack-item-content");!a.id&&a._id?a.id=a._id:!a.id&&!a._id&&(a.id=a._id=c()),o.className=o.className.replace(/grid\-custom/,"");const b=q(x,{item:a});l.innerHTML="",u(b,l)}}),t.on("removed",function(i,s){for(const a of s){const l=a.el.querySelector(".grid-stack-item-content");u(null,l)}}),t.on("change",function(i,s){s=s||[],console.log("gs changed event: ",i,s)})}),N(()=>{});const v=n=>(n&&(t.removeAll(),t.load(n)),t),S=()=>{let n=t.save();return n.map(i=>i.content=""),n},_=()=>{t.removeAll()},k=n=>{t.float(n)},w=n=>{n&&t.compact()};return B(r,()=>{r.pageStatic&&console.log("watch event",r.pageStatic,t)},{deep:!0}),y({props:r,load:v,save:S,clear:_,float:k,compact:w,destroyGrid:n=>{if(t&&n==r.id){console.log("Destroy grid in layout: "+n);try{t.destroy(!0),t=null}catch(i){console.log(i)}}}}),(n,i)=>(m(),g("div",D,[d("div",{ref_key:"gsLayout",ref:h,id:e.id,class:P(["grid-stack",{editable:e.pageStatic==!1}])},[$(n.$slots,"menu"),e.pageStatic?L("",!0):(m(),g("div",O,"Drag to here"))],10,M),V,W]))}}),z=e=>({id:(e==null?void 0:e.id)??`page@${c()}`,title:(e==null?void 0:e.title)??"Create a new Page",static:(e==null?void 0:e.static)??!0,description:(e==null?void 0:e.description)??(e==null?void 0:e.title),icon:(e==null?void 0:e.icon)??"",image:(e==null?void 0:e.image)??"",category:(e==null?void 0:e.category)??"unknown",status:(e==null?void 0:e.status)??"",grids:[{id:`grid@${c()}`,items:[]},{id:`grid@${c()}`,items:[]}]}),F=()=>({id:`grid@${c()}`,items:[]});export{j as _,F as a,z as c};
