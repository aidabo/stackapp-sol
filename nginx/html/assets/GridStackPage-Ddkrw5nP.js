/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{d as z,r as i,s as W,o as q,n as B,a as _,b as s,t as K,e as o,k as r,F as E,g as Q,u as U,h as X,A as Y,C as Z,i as d,w as g,f as N,j as ee,S as te,p as ae,l as se,T as oe,I as ne,_ as le}from"./index-Du6purcr.js";import{c as ie,g as re,_ as ce}from"./base64-BBB2ONEk.js";import{u as ue}from"./PageLayoutStore-CEThXhLB.js";import{u as de,_ as pe}from"./DefaultHandler-DUfvZxXg.js";/* empty css              */const h=v=>(ae("data-v-d93bf9c0"),v=v(),se(),v),fe={class:"flex justify-between align-items-center bg-blue-600 text-white"},_e={class:"ml-4 flex-1"},ve={class:"text-lg font-bold"},me={class:"flex justify-between align-items-center"},ge=h(()=>s("span",null,[s("i",{class:"fa-solid fa-fire"})],-1)),he=[ge],xe=h(()=>s("span",null,[s("i",{class:"fa-solid fa-circle-info"})],-1)),we=[xe],ye={class:"p-3"},be=h(()=>s("i",{class:"fa fa-arrow-circle-left text-2xl","aria-hidden":"true"},null,-1)),Pe=[be],Se={class:"page-show"},ke=h(()=>s("div",{class:"flex flex-col justify-end align-items-center mb-5"},[s("div")],-1)),Ie=z({__name:"GridStackPage",setup(v,{expose:j}){const m=i([]),p=i([]),n=i(ie()),x=i(!0),u=U(),b=X(),F=t=>e=>{e&&(p.value[t]||(p.value[t]=e))},P=async(t,e,a)=>await V(t,e,a),S=de();S.fns.invoke=P;const $=W({...S});Y("__page_handlers",$);const{getPageById:D}=ue(),w=i(!1),y=i(!1),G=i(!0),k=i(!1),I=i([]);q(async()=>{u.params.id&&u.fullPath.match(/\/page\/r/)?O():u.params.id&&u.fullPath.match(/\/page\/p/)?H():w.value=!0});const H=async()=>{let t=localStorage.getItem(u.params.id);if(t){n.value=JSON.parse(re.decode(t));const e=n.value.grids;m.value=e.map(a=>a.id),B(async()=>{await C(e)}),y.value=!0}w.value=!1},O=async()=>{n.value=await D(u.params.id),m.value=n.value.grids.map(t=>t.id),B(async()=>{await C(n.value.grids)}),w.value=!1},C=async t=>{p.value.forEach((e,a)=>{if(e){const l=t[a];e.load(l.items)}else e.load({id:1,x:2,y:1,h:2})})},R=async t=>{await b.push({name:"createpage",params:{id:t}})},J=t=>{b.push({name:"createpageback",params:{id:n.value.id}})},M=()=>{const t=Array();p.value.forEach((a,l)=>{a&&t.push({id:m.value[l],items:a.save()})});const e=JSON.parse(JSON.stringify(n.value));e.grids=t,I.value=e,k.value=!0},T=(t,e)=>p.value.map(a=>a.findCompFn(t,e)).flatMap(a=>a),V=async(t,e,a)=>{const l=T(t,e).map(f=>{let c=f.f(e,a);return c instanceof Promise?c:Promise.resolve(c)});return await Promise.all(l).then(f=>Promise.resolve(f))},A=async()=>{(await P("test2",{cid:"",data:"test data in create! "})).forEach(e=>alert(e))};return j({}),(t,e)=>{const a=oe,l=Z,f=ne;return d(),_(E,null,[s("div",fe,[s("div",_e,[s("h1",ve,K(n.value.title),1)]),s("div",me,[o(l,{class:"mx-3 text-2xl font-bold"},{default:r(()=>[o(a,{content:"just for test"},{default:r(()=>[s("button",{onClick:e[0]||(e[0]=g(c=>A(),["prevent"]))},he)]),_:1})]),_:1}),o(l,{class:"mx-3 text-2xl font-bold"},{default:r(()=>[o(a,{content:"Show page info"},{default:r(()=>[s("button",{onClick:g(M,["prevent"])},we)]),_:1}),o(pe,{show:k.value,items:I.value},null,8,["show","items"])]),_:1}),o(l,{class:"mx-3 text-2xl font-bold"},{default:r(()=>[o(a,{content:"Page preview"},{default:r(()=>[x.value&&!y.value&&G.value?(d(),_("button",{key:0,onClick:e[1]||(e[1]=g(c=>R(n.value.id),["prevent"]))},[s("span",ye,[o(f,{size:"25"})])])):N("",!0)]),_:1})]),_:1}),o(l,{class:"mx-3 text-2xl font-bold"},{default:r(()=>[o(a,{content:"Go back to page design"},{default:r(()=>[x.value&&y.value?(d(),_("button",{key:0,onClick:e[2]||(e[2]=g(c=>J(-1),["prevent"])),class:"text-stone-200 font-bold py-2 px-4 rounded hover:text-white"},Pe)):N("",!0)]),_:1})]),_:1})])]),s("div",Se,[(d(!0),_(E,null,Q(m.value,(c,L)=>(d(),_("div",null,[(d(),ee(te,null,{default:r(()=>[o(ce,{id:c,ref_for:!0,ref:F(L),pageProps:n.value,pageStatic:x.value},null,8,["id","pageProps","pageStatic"])]),_:2},1024))]))),256)),ke])],64)}}}),He=le(Ie,[["__scopeId","data-v-d93bf9c0"]]);export{He as default};
